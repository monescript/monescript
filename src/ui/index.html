<html xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <link href="../../node_modules/c3/c3.css" rel="stylesheet">
    <script src="../../node_modules/d3/d3.min.js" charset="utf-8"></script>
</head>

<body>

    <form id="app">

        <monthly-chart style="width: 100%; height: 200px;" v-bind:column-data="totalInOutData"></monthly-chart>
        <br/>
        <monthly-chart style="width: 100%; height: 200px;" v-bind:column-data="filteredData"></monthly-chart>

        <input type="file" id="input" v-on:change="handleFiles">

        <table>
            <tr><td>
                <account-filter v-model="filter" @input="calculateBalance"></account-filter>
            </td></tr>
            <tr><td>
                <accounts v-bind:accounts="accountTree"> </accounts>
            </td></tr>
        </table>

        <table>
          <tr v-for="t in transactions">
            <td>
              {{t.date.year + '/' + t.date.month + '/' + t.date.day}}
            </td>
            <td>
              {{parseFloat(matchingTxnPosting(t).amount.toFixed(2)).toLocaleString('en-CA', { style: 'currency', currency: 'CAD' })}}
            </td>
            <td>
              {{t.payee}}
            </td>
            <td>
              {{matchingTxnPosting(t).account}}
            </td>
          </tr>
        </table>
    </form>

    <script id="account-filter-template" type="text/x-template">
      <div>
        <label>Account filter: </label>
        <input type="text" @change="updateFilter" v-model.lazy="filter.account"/>
        <label>Month: </label>
        <input type="number" @change="updateFilter" v-model.lazy="filter.month"/>
      </div>
    </script>
    <script id="accounts-template" type="text/x-template">
        <ul>
            <li v-for="(value, key) in level()" >
                <a href="#" >{{ accountDisplay(value) }}</a>
                <div v-if="value.accounts != null && Object.keys(value.accounts).length > 0">
                    <accounts v-bind:accounts="value.accounts"> </accounts>
                </div>
            </li>
        </ul>
    </script>
    <script id="monthly-chart-template" type="text/x-template">
        <div :id="uniqId()"></div>
    </script>

    <script src="_js/bundle.js"></script>
</body>
</html>